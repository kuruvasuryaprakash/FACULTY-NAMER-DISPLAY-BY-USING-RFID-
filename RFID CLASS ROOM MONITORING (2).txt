#include<String.h>
#include <SPI.h>
#include <DMD.h>        
#include <TimerOne.h>   
#include "SystemFont5x7.h"
#include "Arial_black_16.h"
#include<String.h>
#define ROW_MODULE 2
#define COLUMN_MODULE 1 

DMD p10(ROW_MODULE, COLUMN_MODULE);

char message[200];
char char_read;
byte pos_index = 0;
int i;             
char welcome_screen[] = " *** WELCOME ***";
String rtcdata="";
String rtcdata1=" *** WELCOME TO ECE DEPT ***";
String rfidtemp="";
void p10scan()
{ 
  p10.scanDisplayBySPI();
}

void setup()
{
   Serial.begin(9600);
   Timer1.initialize(2000);
   Timer1.attachInterrupt(p10scan);
   p10.clearScreen( true );
   Serial.begin(9600);
   strcpy(message,welcome_screen);
}
void loop()
{
  while(Serial.available())
  {
   String rfid=Serial.readString();
   Serial.println(rfid);
   if(rfid==rfidtemp)
   {
   rtcdata1="WAITING FOR CLASS TEACHER";delay(1000);  
   }
   else
   {
   rfidtemp=rfid;
   if(rfid=="55001A564851")
   {
    rtcdata1="V.MADHURI";delay(1000); 
   }
   else if(rfid=="55001A201C73")
   {
    rtcdata1="CH.RAGHUNATH BABU";delay(1000);
   }
   else if(rfid=="55001ADCFE6D")
   {
    rtcdata1="G.NEELIMA";delay(1000);
   }
else if(rfid=="5500139739E8")
   {
    rtcdata1="M.KALPANA DEVI";delay(1000);
   }
   else if(rfid=="5500128D4A80")
   {
    rtcdata1="Y.NAGA MALLESWARI";delay(1000);
   }
   else if(rfid=="550019E403AB")
   {
    rtcdata1="B.HARINATH BABU ";delay(1000);
   }
   else if(rfid=="55001B030449")
   {
    rtcdata1="P.VIJAY BABU ";delay(1000);
   }
   }

   
  }
  for(i=0; i<199; i++)
        {
            message[i] = '\0';
            //Serial.print(message[i]);
        }
  rtcdata="";
  

rtcdata="  "+String(rtcdata1)+"  "+"$";
int strlength=1;
Serial.println(rtcdata);
         
        for(i=0; rtcdata[i]!='$'; i++)
        {
            message[i] = rtcdata[i];
            //Serial.print(message[i]);
            strlength=strlength+1;
        }      
        pos_index=0;
    
/*
    while(Serial.available() > 0)
    {
       p10.clearScreen( true );27-03-202518:36 
       if(pos_index < (199)) 
       {         
           char_read = Serial.read();
           message[pos_index] = char_read;
           pos_index++;      
       } 
   }
 */
   p10.selectFont(Arial_Black_16);:36 27-03-202518:36 27-03-202518:36 27-03-20
   p10.drawMarquee(message ,strlength,(32*ROW_MODULE)-1,0);
   long start=millis();
   long timer_start=start;
   boolean flag=false;
   while(!flag)
   {
     if ((timer_start+30) < millis()) 
     {
       flag=p10.stepMarquee(-1,0);
       timer_start=millis();delay(10);
     }
   }
}